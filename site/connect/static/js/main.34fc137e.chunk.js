(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(t,e,n){t.exports=n(30)},19:function(t,e,n){},22:function(t,e,n){},3:function(t,e,n){"use strict";(function(t){n.d(e,"c",function(){return o}),n.d(e,"a",function(){return l}),n.d(e,"b",function(){return p});var r=n(1),a=n.n(r),i=n(2),c=12;function o(){return s.apply(this,arguments)}function s(){return(s=Object(i.a)(a.a.mark(function e(){var n,r;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=window.location.hash.substring(1,window.location.hash.length-1),r=t.from(n,"base64"),e.next=5,window.crypto.subtle.importKey("raw",r,{name:"AES-GCM"},!1,["encrypt","decrypt"]);case 5:return e.abrupt("return",e.sent);case 8:return e.prev=8,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 12:case"end":return e.stop()}},e,null,[[0,8]])}))).apply(this,arguments)}function l(t,e){return u.apply(this,arguments)}function u(){return(u=Object(i.a)(a.a.mark(function e(n,r){var i,o,s,l;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.from(r,"base64"),o=i.subarray(0,c),s=i.subarray(c),e.t0=t,e.next=6,window.crypto.subtle.decrypt({name:"AES-GCM",iv:o},n,s);case 6:return e.t1=e.sent,l=e.t0.from.call(e.t0,e.t1).toString("utf-8"),e.abrupt("return",l);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function p(t,e){return d.apply(this,arguments)}function d(){return(d=Object(i.a)(a.a.mark(function t(e,n){var r,i,o,s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=window.crypto.getRandomValues(new Uint8Array(c)),t.next=3,window.crypto.subtle.encrypt({name:"AES-GCM",iv:r},e,(new TextEncoder).encode(n));case 3:return i=t.sent,o=m(r,i),s=h(o),t.abrupt("return",s);case 7:case"end":return t.stop()}},t)}))).apply(this,arguments)}function m(t,e){var n=new Uint8Array(t.byteLength+e.byteLength);return n.set(new Uint8Array(t),0),n.set(new Uint8Array(e),t.byteLength),n.buffer}function h(t){for(var e=new Uint8Array(t),n="",r=e.byteLength,a=0;a<r;a++)n+=String.fromCharCode(e[a]);return window.btoa(n)}}).call(this,n(25).Buffer)},30:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),i=n(6),c=n.n(i),o=(n(19),n(1)),s=n.n(o),l=n(2),u=n(7),p=n(8),d=n(13),m=n(12),h=n(4),f=(n(22),n(23),n(9)),w=n.n(f),b=n(10),y=n(11),v=n.n(y),E=n(3);function x(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=Object(h.a)(t);if(e){var a=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Object(m.a)(this,n)}}function g(t){return a.a.createElement("div",{className:"flexnowrap"},a.a.createElement("div",{className:"led led-".concat(t.color)}),a.a.createElement("div",null,t.text))}function k(t){return a.a.createElement("div",{id:"top"},a.a.createElement("a",{href:"https://github.com/cs01/termpair"},a.a.createElement("img",{height:"30px",src:w.a,alt:"logo"})))}function j(t){return a.a.createElement("div",{id:"statusbar"}," ",a.a.createElement("div",null,"connected"===t.status?a.a.createElement(g,{color:"green",text:t.status}):a.a.createElement(g,{color:"red",text:t.status})),a.a.createElement("div",null,t.terminalData.allow_browser_control&&"connected"===t.status?a.a.createElement(g,{color:"green",text:"can type"}):a.a.createElement(g,{color:"orange",text:"cannot type"})),a.a.createElement("div",null,t.terminalData.num_clients?t.terminalData.num_clients:"0"," ","Connected Clients"),a.a.createElement("div",null,"Started at"," ",v()(t.terminalData.broadcast_start_time_iso).format("h:mm:ss a on MMM Do YYYY")))}function O(){return a.a.createElement("div",{id:"bottom"},a.a.createElement("div",null,"A ",a.a.createElement("a",{href:"https://grassfedcode.com"},"Chad Smith")," project"),a.a.createElement("div",null,a.a.createElement("a",{href:"https://github.com/cs01"},"GitHub")))}function _(t){t.writeln("To broadcast a terminal, run");var e="".concat(window.location.protocol,"//").concat(window.location.hostname).concat(window.location.pathname);t.writeln("");var n=window.location.port;window.location.port||(n="https:"===window.location.protocol?443:80),t.writeln('    pipx run termpair share --host "'.concat(e,'" --port ').concat(n)),t.writeln(""),t.writeln("Then open or share the url printed to the terminal."),t.writeln("To install pipx, see https://pipxproject.github.io/pipx/"),t.writeln("All terminal data is end-to-end encrypted \ud83d\udd12."),t.writeln("The termpair server and third parties can't read transmitted data.")}var S=function(t){Object(d.a)(n,t);var e=x(n);function n(t){var r;Object(u.a)(this,n),r=e.call(this,t);var i=new URLSearchParams(window.location.search).get("terminal_id"),c=null!=window.crypto&&null!=window.crypto.subtle;r.state={terminalData:{},terminalId:i,hasCrypto:c,status:i&&c?"connection-pending":"disconnected",num_clients:null,secretEncryptionKey:"pending"},r.xterm=new b.Terminal({cursorBlink:!0,macOptionIsMeta:!0,scrollback:1e3}),r.terminalRef=a.a.createRef();return r.xterm.resize(90,20),r}return Object(p.a)(n,[{key:"render",value:function(){return a.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},a.a.createElement(k,Object.assign({},this.props,this.state)),a.a.createElement("div",{id:"terminal",ref:this.terminalRef.current}),this.state.terminalId?a.a.createElement(j,Object.assign({},this.props,this.state)):null,a.a.createElement(O,null))}},{key:"componentDidMount",value:function(){var t=Object(l.a)(s.a.mark(function t(){var e,n,r,a,i,c,o,u=this;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=function(){return(o=Object(l.a)(s.a.mark(function t(r){var a,i,c;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("new_output"!==(a=JSON.parse(r.data)).event){t.next=9;break}return i=a.payload,t.next=5,Object(E.a)(n,i);case 5:c=t.sent,e.writeUtf8(c),t.next=10;break;case 9:"resize"===a.event?(clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){e.resize(a.payload.cols,a.payload.rows)},500)):"num_clients"===a.event?(this.state.terminalData.num_clients=a.payload,this.setState({terminalData:this.state.terminalData})):console.error("unknown event type",a);case 10:case"end":return t.stop()}},t,this)}))).apply(this,arguments)},c=function(t){return o.apply(this,arguments)},(e=this.xterm).open(document.getElementById("terminal")),this.state.hasCrypto){t.next=9;break}return e.writeln("\x1b[1;31mFatal Error: TermPair only works on secure connections. Ensure url starts with https. See `termpair serve --help` for more information.\x1b[0m"),e.writeln(""),_(e),t.abrupt("return");case 9:return t.next=11,Object(E.c)();case 11:return n=t.sent,console.warn(n),this.setState({secretEncryptionKey:n}),"http://127.0.0.1:9000/",t.next=17,fetch("".concat("http://127.0.0.1:9000/","terminal/").concat(this.state.terminalId));case 17:return t.next=19,t.sent.json();case 19:if(r=t.sent,this.setState({terminalData:r}),e.writeln("Welcome to TermPair! https://github.com/cs01/termpair"),e.writeln(""),r.terminal_id){t.next=28;break}return _(e),t.abrupt("return");case 28:if(n){t.next=31;break}return _(e),t.abrupt("return");case 31:"https:"===window.location.protocol?"wss":"ws",a="ws://127.0.0.1:9000/connect_browser_to_terminal?terminal_id=".concat(this.state.terminalId),i=new WebSocket(a),e.onKey(function(){var t=Object(l.a)(s.a.mark(function t(e,r){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=i,t.next=3,Object(E.b)(n,e.key);case 3:t.t1=t.sent,t.t0.send.call(t.t0,t.t1);case 5:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()),i.addEventListener("open",function(t){u.setState({status:"connected"}),e.writeln("Connection established with end-to-end encryption \ud83d\udd12."),e.writeln("The termpair server and third parties can't read transmitted data.")}),i.addEventListener("close",function(t){"connected"===u.state.status?e.writeln("Connection ended"):e.writeln("Failed to establish connection. Ensure you have a valid url."),_(e),u.setState({status:"disconnected"}),u.setState({num_clients:0})}),i.addEventListener("message",c.bind(this));case 38:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}]),n}(r.Component);c.a.render(a.a.createElement(S,null),document.getElementById("root"))},9:function(t,e,n){t.exports=n.p+"static/media/logo.74cdedb8.png"}},[[14,1,2]]]);
//# sourceMappingURL=main.34fc137e.chunk.js.map